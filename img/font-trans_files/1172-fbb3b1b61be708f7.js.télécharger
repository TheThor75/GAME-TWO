"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1172],{63944:function(e,n,t){t.d(n,{Q5:function(){return o},Wt:function(){return u},ZU:function(){return c},ld:function(){return l}});var s=t(47568),a=t(97582),r=function(){return sessionStorage.getItem("idBusiness")},i=function(e){var n,t=sessionStorage.getItem("user");return t&&null!==(n=JSON.parse(t)[e])&&void 0!==n?n:null},o=function(){var e=(0,s.Z)((function(e){var n,t,s=arguments;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return s.length>1&&void 0!==s[1]&&s[1],n="scheduleData",[4,e("/sms/get-existing-schedule-data",{businessID:r()})];case 1:return(t=a.sent()).status?(localStorage.setItem(n,JSON.stringify(t.content)),[2,t.content]):[2,null]}}))}));return function(n){return e.apply(this,arguments)}}(),l=function(){var e=(0,s.Z)((function(e,n,t,s,o,l,u){var c;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return[4,e("/sms/add-blog-schedule",{businessID:r(),userEmail:i("email"),isBlogPostEnabled:n,selectedSchedule:t,isNotificationEnabled:s,phoneNumber:o,countryCode:l,existingScheduleID:u})];case 1:return[2,null===(c=a.sent())||void 0===c?void 0:c.status]}}))}));return function(n,t,s,a,r,i,o){return e.apply(this,arguments)}}(),u=function(){var e=(0,s.Z)((function(e,n){var t;return(0,a.__generator)(this,(function(s){switch(s.label){case 0:return[4,e("/sms/verify-business-phone-number",{businessID:r(),verificationCode:n,email:i("email"),location:i("location")})];case 1:return[2,null===(t=s.sent())||void 0===t?void 0:t.verificationStatus]}}))}));return function(n,t){return e.apply(this,arguments)}}(),c=function(){var e=(0,s.Z)((function(e,n,t){var s;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return[4,e("/sms/resend-otp-code",{businessID:r(),countryCode:n,phoneNumber:t})];case 1:return[2,null===(s=a.sent())||void 0===s?void 0:s.isCodeResent]}}))}));return function(n,t,s){return e.apply(this,arguments)}}();(function(){var e=(0,s.Z)((function(e,n,t){var s;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return[4,e("/sms/send-code",{businessID:r(),userEmail:i("email"),phoneNumber:t,countryCode:n})];case 1:return[2,null===(s=a.sent())||void 0===s?void 0:s.status]}}))}))})(),function(){var e=(0,s.Z)((function(e,n,t){var s;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return[4,e("/sms/resend-code",{businessID:r(),countryCode:n,phoneNumber:t})];case 1:return[2,null===(s=a.sent())||void 0===s?void 0:s.status]}}))}))}(),function(){var e=(0,s.Z)((function(e,n){var t;return(0,a.__generator)(this,(function(s){switch(s.label){case 0:return[4,e("/sms/verify-code",{businessID:r(),verificationCode:n})];case 1:return[2,null===(t=s.sent())||void 0===t?void 0:t.content]}}))}))}()},1172:function(e,n,t){t.d(n,{Z:function(){return Z}});var s=t(47568),a=t(26042),r=t(69396),i=t(97582),o=t(85893),l=t(10253),u=t(67294),c=t(83441),d=t(80360),f=t(51121),h=function(e){return e.replace("+1","").replace(/^(\d{3})(\d{3})(\d{4})$/,"($1) $2-$3")},m=function(e){var n=e.label,t=e.placeholder,s=e.informationProvidedCallback,a=e.showPrefix,r=void 0===a||a,i=e.existingInformation,m=[{id:"us",name:"+1",icon:(0,o.jsx)(c.Z,{countryCode:"US","aria-label":"United States",svg:!0})},{id:"ca",name:"+1",icon:(0,o.jsx)(c.Z,{countryCode:"CA","aria-label":"Canada",svg:!0})}],v=(0,l.Z)(u.useState(""),2),x=v[0],p=v[1],g=(0,l.Z)(u.useState(m[0]),2),b=g[0],N=g[1];return(0,u.useEffect)((function(){i&&p(i.notFormatted)}),[]),(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(f.Z,{label:n,placeholder:t,value:x,prefix:r&&(0,o.jsx)(d.Z,{className:"w-full",values:m,value:b,icon:b.icon,showOptionIcon:!0,onChange:N,buttonBorder:!1}),addPrefixPadding:!1,onChange:function(e){if(!(e.length>15)){var n=e.replace(/\D/g,"");n.length<=3?p(n):n.length<=6?p("(".concat(n.substring(0,3),") ").concat(n.substring(3))):n.length<=10&&p("(".concat(n.substring(0,3),") ").concat(n.substring(3,6),"-").concat(n.substring(6)));var t=n.trim().replace(/[\s\(\)-]+/g,"");s({notFormatted:h(t),formatted:"".concat(b.name).concat(t),isNumberValid:10===t.length})}}})})},v=t(12280),x=t(52077),p=t(43490),g=t(58386),b=t(16494),N=t(3732),j=t(63944),y=t(4519),C=function(e){var n=e.children,t=e.isModalOpen,s=e.setIsModalOpen;return(0,o.jsx)(v.u,{open:t,fixedHeight:!0,hasCustomBody:!0,children:(0,o.jsxs)("div",{className:"flex flex-col text-center md:max-w-sm",children:[(0,o.jsx)("img",{src:"https://cdn.durable.co/assets/auto-post/auto-post-on-modal-header.svg",alt:"Auto-post on modal header image.",className:"h-40 md:w-96"}),(0,o.jsxs)("div",{className:"flex flex-col gap-8 p-8",children:[(0,o.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,o.jsx)("p",{className:"text-gray-900 text-xl font-semibold leading-6",children:"You\u2019re all set up for auto-post!"}),(0,o.jsx)("p",{className:"text-gray-900 text-base font-normal leading-6",children:n})]}),(0,o.jsx)("div",{children:(0,o.jsx)("button",{className:"py-3.5 px-4 border-1 border-gray-300 rounded-md",onClick:function(){return s(!1)},children:"Close"})})]})]})})},Z=function(e){var n=e.showModal,t=e.showModalHandler,l=e.scheduleData,c=e.setScheduleData,f=e.onComplete,Z=e.allowToggleStatus,w=void 0===Z||Z,S=null===l||void 0===l?void 0:l.existingScheduleData,_=(0,u.useState)(!1),E=_[0],I=_[1],D=(0,u.useState)(!0),P=D[0],F=D[1],O=(0,u.useState)(!0),k=O[0],A=O[1],V=(0,u.useState)({notFormatted:"",formatted:"",isNumberValid:!1}),B=V[0],T=V[1],M=(0,u.useState)(""),R=M[0],U=M[1],H=(0,u.useState)(!0),$=H[0],W=H[1],Y=(0,u.useState)(!1),q=Y[0],J=Y[1],L=(0,u.useState)(!1),Q=L[0],X=L[1],z=(0,u.useState)({id:"",name:""}),G=z[0],K=z[1],ee=(0,u.useState)(!1),ne=ee[0],te=ee[1],se=(0,u.useState)(!1),ae=se[0],re=se[1],ie="DISABLED",oe=(0,u.useState)({phoneNumber:null,isEnabled:null,isNotificationEnabled:null,name:null}),le=oe[0],ue=oe[1],ce=(0,y.Z)(),de=ce.post,fe=ce.get,he=function(e){var n,t,s,a,r,i,o,u=null!==(a=null===e||void 0===e?void 0:e.existingScheduleData)&&void 0!==a?a:S,c=(null===u||void 0===u?void 0:u.name)&&(null===u||void 0===u?void 0:u.name)!==ie?null===u||void 0===u?void 0:u.name:null,d=(null===u||void 0===u||null===(n=u.BusinessPhoneNumber)||void 0===n?void 0:n.verified)&&(null===u||void 0===u?void 0:u.isNotificationEnabled);ue({phoneNumber:null!==(r=null===u||void 0===u||null===(t=u.BusinessPhoneNumber)||void 0===t?void 0:t.phoneNumber)&&void 0!==r?r:"",isEnabled:null!==(i=null===u||void 0===u?void 0:u.isEnabled)&&void 0!==i&&i,isNotificationEnabled:null===d||void 0===d||d,name:null!==c&&void 0!==c?c:me()[0].id});var f,m=(null!==(o=null===u||void 0===u?void 0:u.BusinessPhoneNumber)&&void 0!==o?o:{phoneNumber:"",verified:!0}).phoneNumber;K(c?{id:c,name:null===(s=null===l||void 0===l?void 0:l.schedules[c])||void 0===s?void 0:s.displayText}:me()[0]),I(null===(f=null===u||void 0===u?void 0:u.isEnabled)||void 0===f||f),F(null===d||void 0===d||d),T(m?{notFormatted:m?h(m):"",formatted:m||"",isNumberValid:!0}:{notFormatted:"",formatted:"",isNumberValid:!1}),A(!0),U(""),W(!0),J(!1),X(!1),te(!1)},me=function(){return(null===l||void 0===l?void 0:l.schedules)?Object.values(null===l||void 0===l?void 0:l.schedules).map((function(e){return{id:e.name,name:e.displayText}})):{schedules:[],selectedSchedule:{}}},ve=function(){var e=(0,s.Z)((function(){var e;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,j.Q5)(fe,!0)];case 1:return e=n.sent(),c(e),he(e),[2]}}))}));return function(){return e.apply(this,arguments)}}(),xe=function(e){T(e)},pe=function(){var e=(0,s.Z)((function(){var e;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,j.ld)(de,E,G.id,P,B.formatted,null===l||void 0===l?void 0:l.countryCode,null!==(e=null===S||void 0===S?void 0:S._id)&&void 0!==e?e:null)];case 1:return[2,n.sent()]}}))}));return function(){return e.apply(this,arguments)}}(),ge=function(){var e=(0,s.Z)((function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return J(!0),[4,(0,j.Wt)(de,R)];case 1:switch(e.sent()){case"VERIFIED":return[3,2];case"EXPIRED":return[3,4]}return[3,5];case 2:return t(!1),re(!0),[4,ve()];case 3:return e.sent(),[3,6];case 4:return N.Z9.error("OTP verification code expired. Please request a new code.",{autoClose:!0}),[3,6];case 5:return N.Z9.error("OTP verification failed.",{autoClose:!0}),[3,6];case 6:return J(!1),[2]}}))}));return function(){return e.apply(this,arguments)}}(),be=function(){var e=(0,s.Z)((function(){var e;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return!E||!P||B.formatted&&B.isNumberValid?(X(!0),[4,pe()]):(N.Z9.error("Please enter a valid phone number.",{autoClose:!0}),[2]);case 1:return"FAILED"===(e=n.sent())?(X(!1),N.Z9.error("Failed to save schedule.",{autoClose:!0}),[2]):[4,ve()];case 2:return n.sent(),te(!1),"NEEDS_VERIFICATION"!==e?("function"===typeof f?f():t(!1),E?re(!0):N.Z9.success(E?"Auto-post on":"Auto-post off",{autoClose:!0})):A(!1),[2]}}))}));return function(){return e.apply(this,arguments)}}(),Ne=function(){var e;S&&(null===S||void 0===S||null===(e=S.BusinessPhoneNumber)||void 0===e?void 0:e.verified)?(T({notFormatted:"",formatted:"",isNumberValid:!1}),X(!1),A(!0)):(he(),t(!1))},je=function(){F(!P)},ye=function(){var e=(0,s.Z)((function(){var e,n;return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return e=null===l||void 0===l?void 0:l.countryCode,n=B.formatted,e&&n?[4,(0,j.ZU)(de,e,n)]:(N.Z9.error("Unable to request a new code right now, please try again later",{autoClose:!0}),[2]);case 1:return t.sent()?(U(""),N.Z9.success("OTP code sent.",{autoClose:!0}),[2]):(N.Z9.error("Failed to resend OTP code. Please try again later.",{autoClose:!0}),[2])}}))}));return function(){return e.apply(this,arguments)}}();return(0,u.useEffect)((function(){6===R.length&&W(!1)}),[R]),(0,u.useEffect)((function(){he()}),[]),(0,u.useEffect)((function(){te(le.phoneNumber!==B.formatted&&B.isNumberValid||le.isEnabled!==E||le.isNotificationEnabled!==P||le.name!==G.id)}),[G,E,P,B,te,le]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(v.u,{title:k?"Automate posts":null,buttons:k&&(0,o.jsxs)("div",{className:"flex flex-row gap-3",children:[(0,o.jsx)(x.Z,{onClick:function(){return t(!1)},disabled:Q,className:"secondary",children:"Cancel"}),(0,o.jsx)("button",{onClick:be,className:"relative primary w-full",disabled:!ne||Q,children:Q?(0,o.jsx)(b.Z,{text:""}):"Save"})]}),open:n,setOpen:function(){he(),t(!1)},fixedHeight:!1,footerHasMarginTop:E,children:k?(0,o.jsxs)(o.Fragment,{children:[w&&(0,o.jsx)("div",{children:(0,o.jsxs)("div",{className:"flex gap-6",children:[(0,o.jsx)("p",{children:"Draft blog posts automatically using AI"}),(0,o.jsx)("span",{className:"flex-grow"}),(0,o.jsx)(p.Z,{enabled:E,onChange:I})]})}),E&&(0,o.jsxs)(o.Fragment,{children:[w&&(0,o.jsx)("hr",{className:"mt-1 mb-1"}),(0,o.jsxs)("div",{children:[(0,o.jsx)("p",{className:"h6 font-semibold text-gray-900 mb-3",children:"Schedule"}),(0,o.jsx)(d.Z,{className:"w-full mb-2",values:me(),value:G,onChange:K}),(0,o.jsx)("p",{className:"label font-normal text-gray-500",children:(null===S||void 0===S?void 0:S.isEnabled)&&(null===S||void 0===S?void 0:S.name)!==ie?"Ongoing":"Starting today"})]}),(0,o.jsx)("hr",{className:"mt-1 mb-1"}),(0,o.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,o.jsxs)("div",{className:"flex gap-6",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("p",{className:"h6 font-semibold text-gray-900 mb-1",children:"Notifications"}),(0,o.jsx)("p",{className:"label font-normal text-gray-500 mb-6",children:"Send a text message when drafts are ready"})]}),(0,o.jsx)("span",{className:"flex-grow"}),(0,o.jsx)(p.Z,{enabled:P,onChange:je})]}),P&&(0,o.jsx)(m,{label:"Phone",informationProvidedCallback:xe,showPrefix:!1,existingInformation:B})]})]})]}):(0,o.jsx)("div",{className:"p-4",children:(0,o.jsxs)("div",{className:"flex flex-col text-center gap-8",children:[(0,o.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("p",{className:"h6",children:"Please verify your phone number"}),(0,o.jsx)("p",{className:"h6",children:"by entering the 6 digit code sent to"})]}),(0,o.jsx)("div",{children:(0,o.jsx)("span",{className:"text-sm pl-1 pr-1 pt-2 pb-2 rounded-md bg-gray-100",children:B.notFormatted})}),(0,o.jsx)("p",{className:"label font-normal text-gray-500",children:"You'll only have to do this once."})]}),(0,o.jsx)("div",{className:"flex items-center justify-center",children:(0,o.jsx)(g.Z,{value:R,onChange:U,numInputs:6,renderInput:function(e){return(0,o.jsx)("input",(0,r.Z)((0,a.Z)({},e),{className:""}))},inputStyle:{width:"2.69rem",height:"2.5rem"},containerStyle:{display:"flex",gap:"0.5rem"},shouldAutoFocus:!0})}),(0,o.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,o.jsx)("button",{onClick:ge,className:"relative primary w-full",disabled:q||$,children:q?(0,o.jsx)(b.Z,{text:""}):"Verify"}),(0,o.jsxs)("div",{className:"flex",children:[(0,o.jsx)(x.Z,{onClick:Ne,loading:!1,disabled:!1,className:"light",children:"Cancel"}),(0,o.jsx)("span",{className:"flex-grow"}),(0,o.jsx)(x.Z,{onClick:ye,loading:!1,disabled:!1,className:"light",children:"Resend code"})]})]})]})})}),(0,o.jsx)(C,{isModalOpen:ae,setIsModalOpen:re,children:P?"We've sent a confirmation text message, and you\u2019ll get another one when your first post is ready for review.":"You'll see new draft posts appear on the schedule you chose."})]})}}}]);