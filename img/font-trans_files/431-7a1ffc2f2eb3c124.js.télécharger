"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[431],{67568:function(e,n,s){s.d(n,{S:function(){return d},Z:function(){return c}});var i=s(10253),a=s(85893),t=s(61437),o=s(11355),l=s(67294),r=s(3732);function d(e){var n=e.children,s=e.text,i=e.dirty;e.className;return(0,a.jsx)(o.u,{as:l.Fragment,show:i,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,a.jsxs)("div",{className:"sticky bottom-0 z-50 flex items-center justify-between gap-3 p-4 sm:px-6 bg-white border-t border-gray-100 lg:rounded-b-lg",children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:null!==s&&void 0!==s?s:"Save changes?"}),(0,a.jsx)("div",{className:"flex items-center gap-3",children:n})]})})}function c(e){var n=e.children,s=e.dirty,o=e.className,l=e.fullBorder,d=void 0!==l&&l,c=(0,i.Z)((0,t.Z)("layout.sidebarOpen"),2),u=c[0];c[1];return(0,a.jsx)("div",{className:(0,r.AK)(s?"bottom-0 opacity-100":"-bottom-80 opacity-0","fixed left-0 right-0 z-90 lg:z-50 bg-gray-50 transition-all duration-300 lg:rounded-b-lg",u?"md:left-[15.5rem]":"md:left-24",d?"md:px-0":"md:px-6",o),children:(0,a.jsx)("div",{className:(0,r.AK)("flex items-center justify-between gap-3 py-4 px-6 border-t border-gray-300",d?"md:px-6":"md:px-0"),children:n})})}},97231:function(e,n,s){s.r(n),s.d(n,{default:function(){return B},states:function(){return L}});var i=s(47568),a=s(26042),t=s(69396),o=s(10253),l=s(29815),r=s(97582),d=s(85893),c=s(67294),u=s(30120),m=s(41664),f=s.n(m),v=s(33299),h=s(61437),p=s(11163),x=s(32130),g=s(43490),b=s(52699),N=s(3732),Z=s(16494),y=s(51121),j=s(80360),C=s(4519),w=s(26713),S=s(67568),M=s(52077),A=s(53371),k=s(11215),I=s(43714),O=s(22295),L={us:[{id:"",name:"Select"},{id:"AL",name:"Alabama (AL)"},{id:"AK",name:"Alaska (AK)"},{id:"AZ",name:"Arizona (AZ)"},{id:"AR",name:"Arkansas (AR)"},{id:"CA",name:"California (CA)"},{id:"CO",name:"Colorado (CO)"},{id:"CT",name:"Connecticut (CT)"},{id:"DE",name:"Delaware (DE)"},{id:"DC",name:"District Of Columbia (DC)"},{id:"FL",name:"Florida (FL)"},{id:"GA",name:"Georgia (GA)"},{id:"HI",name:"Hawaii (HI)"},{id:"ID",name:"Idaho (ID)"},{id:"IL",name:"Illinois (IL)"},{id:"IN",name:"Indiana (IN)"},{id:"IA",name:"Iowa (IA)"},{id:"KS",name:"Kansas (KS)"},{id:"KY",name:"Kentucky (KY)"},{id:"LA",name:"Louisiana (LA)"},{id:"ME",name:"Maine (ME)"},{id:"MD",name:"Maryland (MD)"},{id:"MA",name:"Massachusetts (MA)"},{id:"MI",name:"Michigan (MI)"},{id:"MN",name:"Minnesota (MN)"},{id:"MS",name:"Mississippi (MS)"},{id:"MO",name:"Missouri (MO)"},{id:"MT",name:"Montana (MT)"},{id:"NE",name:"Nebraska (NE)"},{id:"NV",name:"Nevada (NV)"},{id:"NH",name:"New Hampshire (NH)"},{id:"NJ",name:"New Jersey (NJ)"},{id:"NM",name:"New Mexico (NM)"},{id:"NY",name:"New York (NY)"},{id:"NC",name:"North Carolina (NC)"},{id:"ND",name:"North Dakota (ND)"},{id:"OH",name:"Ohio (OH)"},{id:"OK",name:"Oklahoma (OK)"},{id:"OR",name:"Oregon (OR)"},{id:"PA",name:"Pennsylvania (PA)"},{id:"RI",name:"Rhode Island (RI)"},{id:"SC",name:"South Carolina (SC)"},{id:"SD",name:"South Dakota (SD)"},{id:"TN",name:"Tennessee (TN)"},{id:"TX",name:"Texas (TX)"},{id:"UT",name:"Utah (UT)"},{id:"VT",name:"Vermont"},{id:"VA",name:"Virginia"},{id:"WA",name:"Washington"},{id:"WV",name:"West Virginia"},{id:"WI",name:"Wisconsin"},{id:"WY",name:"Wyoming"},{id:"AS",name:"American Samoa (AS)"},{id:"GU",name:"Guam (GU)"},{id:"MP",name:"Northern Mariana Islands (MP)"},{id:"PR",name:"Puerto Rico (PR)"},{id:"UM",name:"United States Minor Outlying Islands (UM)"},{id:"VI",name:"Virgin Islands (VI)"}],ca:[{id:"",name:"Select"},{id:"AB",name:"Alberta (AB)"},{id:"BC",name:"British Columbia (BC)"},{id:"MB",name:"Manitoba (MB)"},{id:"NB",name:"New Brunswick (NB)"},{id:"NL",name:"Newfoundland and Labrador (NL)"},{id:"NS",name:"Nova Scotia (NS)"},{id:"ON",name:"Ontario (ON)"},{id:"PE",name:"Prince Edward Island (PE)"},{id:"QC",name:"Quebec (QC)"},{id:"SK",name:"Saskatchewan (SK)"},{id:"NT",name:"Northwest Territories (NT)"},{id:"NU",name:"Nunavut (NU)"},{id:"YT",name:"Yukon (YT)"}]},D="default",T="changed",E="updated";function B(){(0,o.Z)((0,h.Z)("layout.title","Business",!0),0);var e,n,s,m,B,P,_,F,K,Y,R,U,V,H,W,z,G,J,q,Q,$,X,ee,ne,se,ie=(0,c.useState)([]),ae=ie[0],te=ie[1],oe=(0,c.useState)(!1),le=oe[0],re=oe[1],de=(0,c.useState)(!0),ce=de[0],ue=de[1],me=(0,c.useState)((0,N.tl)("business.config")),fe=me[0],ve=me[1],he=(0,c.useState)(!1),pe=he[0],xe=he[1],ge=(0,c.useState)(!1),be=ge[0],Ne=ge[1],Ze=(0,c.useState)(null),ye=Ze[0],je=Ze[1],Ce=(0,c.useState)(D),we=Ce[0],Se=Ce[1],Me=(0,c.useState)(!1),Ae=Me[0],ke=Me[1],Ie=(0,N.ac)("(max-width: 767px)"),Oe=(0,p.useRouter)(),Le=(0,v.useSession)().data,De=(0,C.Z)(),Te=De.get,Ee=De.post,Be=(0,c.useState)(!1),Pe=Be[0],_e=Be[1],Fe=(0,I.Z)().track,Ke=(0,k.Z)().reloadBusinesses,Ye=(0,b.Z)().getConfig,Re=function(){var e=(0,i.Z)((function(){var e,n,s,i;return(0,r.__generator)(this,(function(a){switch(a.label){case 0:return re(!0),[4,Te("/business/get-config")];case 1:return(e=a.sent())&&!0===e.status&&e.content?(je((0,N.p$)(e.content)),(0,N.Fs)("business.config",e.content),ve(e.content),xe(!!(null===(n=e.content)||void 0===n||null===(s=n.office)||void 0===s||null===(i=s.address)||void 0===i?void 0:i.public))):ve(null),re(!1),[2]}}))}));return function(){return e.apply(this,arguments)}}(),Ue=function(){var e=(0,i.Z)((function(){var e,n,s,i;return(0,r.__generator)(this,(function(o){switch(o.label){case 0:return[4,Te("/business/get-business-types").catch(console.log)];case 1:return e=o.sent(),n=[],e&&((s=n).push.apply(s,(0,l.Z)(e.content.map((function(e){var n=e._id;return delete e._id,(0,t.Z)((0,a.Z)({},e),{id:n})})))),i=n.find((function(e){return"Other"===e.name})),(n=n.filter((function(e){return e.id!==i.id}))).push(i)),te(n),[2]}}))}));return function(){return e.apply(this,arguments)}}(),Ve=function(){var e=(0,i.Z)((function(){var e,n,s;return(0,r.__generator)(this,(function(i){switch(i.label){case 0:return ue(!0),re(!0),fe.business.name&&fe.business.type.name?[3,1]:(ue(!1),re(!1),[3,6]);case 1:return[4,Ee("/business/save",fe).catch(console.log)];case 2:return e=i.sent(),n=we===T,e&&!0===e.status?[4,Ke()]:[3,4];case 3:return i.sent(),Ye(),N.Z9.success("Settings saved!"),je((0,N.p$)(fe)),(0,N.Fs)("business.config",fe),n&&(Se(E),null===(s=document.querySelector(".main-scrollbar"))||void 0===s||s.scrollTo({top:0,behavior:"smooth"})),[3,5];case 4:N.Z9.error(e.message),i.label=5;case 5:re(!1),i.label=6;case 6:return[2]}}))}));return function(){return e.apply(this,arguments)}}();(0,c.useEffect)((function(){fe&&ye&&(JSON.stringify(ye)===JSON.stringify(fe)?Ne(!1):(Ne(!0),JSON.stringify(ye.business.type)===JSON.stringify(fe.business.type)?Se(D):Se(T)))}),[fe,ye]),(0,c.useEffect)((function(){var e;if(fe&&ae&&(null===Oe||void 0===Oe||null===(e=Oe.query)||void 0===e?void 0:e.scroll)){var n,s=document.getElementById(null===Oe||void 0===Oe||null===(n=Oe.query)||void 0===n?void 0:n.scroll);s&&(s.scrollIntoView({behavior:"smooth"}),Oe.push("/my-business/settings",void 0,{shallow:!0}))}}),[Oe,fe,ae]),(0,c.useEffect)((function(){Re(),Ue()}),[]);var He,We=!!(null===Le||void 0===Le||null===(e=Le.user)||void 0===e?void 0:e.stripeOnboardingStatus)&&"none"===(null===Le||void 0===Le||null===(n=Le.user)||void 0===n?void 0:n.stripeOnboardingStatus),ze=N.hW.find((function(e){var n,s,i,a;return e.code.toLowerCase()===(null!==(He=null===fe||void 0===fe||null===(n=fe.office)||void 0===n||null===(s=n.address)||void 0===s?void 0:s.country.toLowerCase())&&void 0!==He?He:null===Le||void 0===Le||null===(i=Le.user)||void 0===i||null===(a=i.location)||void 0===a?void 0:a.toLowerCase())}));return ze&&(ze.id=ze.code),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(A.Z,{context:"sync_email",open:Pe,setOpen:_e}),(0,d.jsxs)("div",{className:"flex flex-col gap-5 max-w-3xl mx-auto",children:[(!fe||!(null===ae||void 0===ae?void 0:ae.length))&&(0,d.jsx)(Z.Z,{variant:"form",className:"mb-4"}),fe&&(null===ae||void 0===ae?void 0:ae.length)>0&&fe.business&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(S.Z,{dirty:be,children:[(0,d.jsx)("p",{className:"text-sm font-medium",children:"Unsaved"}),(0,d.jsxs)("div",{className:"flex items-center gap-3",children:[(0,d.jsx)("button",{className:"secondary",disabled:le,onClick:function(){return function(){var e=(0,N.p$)(ye);ve(e),Ne(!1)}()},children:"Discard"}),(0,d.jsx)(M.Z,{className:"primary",onClick:function(){return Ve()},loading:le,children:"Save"})]})]}),(0,d.jsxs)("div",{className:"p-4 md:p-6 bg-white rounded-lg shadow",children:[(0,d.jsxs)("div",{className:"mb-6",children:[(0,d.jsx)("h5",{className:"mb-1",children:"Details"}),(0,d.jsx)("p",{className:"text-gray-500",children:"Business name, description, contacts and address."})]}),(0,d.jsx)(y.Z,{label:"Name",name:"name",type:"text",value:fe.business.name,onChange:function(e){return ve((0,t.Z)((0,a.Z)({},fe),{business:(0,t.Z)((0,a.Z)({},fe.business),{name:e})}))},error:ce||fe.business.name?"":"You must provide a Business name"}),(0,d.jsx)("div",{className:"flex-1 mt-4",children:(0,d.jsx)(y.Z,{label:"Describe your business",type:"textarea",value:null===(s=fe.business)||void 0===s||null===(m=s.type)||void 0===m?void 0:m.name,placeholder:"E.g. My business is a landscaping company that specializes in residential properties.",error:ce||fe.business.type.name?"":"Please describe your business.",autoresize:!0,maxHeight:200,allowNewLines:!0,size:1200,onChange:function(e){var n=ae.find((function(e){return"Other"===e.name}));ve((0,t.Z)((0,a.Z)({},fe),{business:(0,t.Z)((0,a.Z)({},fe.business),{type:{Type:(0,t.Z)((0,a.Z)({},n),{_id:n.id}),name:e}})}))}})}),we===E&&(0,d.jsxs)("div",{className:"alert bg-indigo-50 mt-4",children:[(0,d.jsx)("p",{className:"text-sm font-medium text-indigo-900",children:"You changed your business type. Do you want to regenerate your website?"}),(0,d.jsxs)("div",{className:"flex gap-3 items-center",children:[(0,d.jsx)("button",{className:"secondary",onClick:function(){return Se(D)},children:"Dismiss"}),(0,d.jsx)("button",{className:"primary",onClick:function(){Fe("app:business-details-regenerate"),ke(!0)},children:"Regenerate"})]})]}),(0,d.jsx)("hr",{}),(0,d.jsx)("label",{className:"lg mb-4",children:"Contact"}),(0,d.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 mt-4 gap-4",children:[(0,d.jsx)(y.Z,{label:"First Name",name:"firstName",value:null===(B=fe.office.contact)||void 0===B?void 0:B.firstName,onChange:function(e){return ve((0,t.Z)((0,a.Z)({},fe),{office:(0,t.Z)((0,a.Z)({},fe.office),{contact:(0,t.Z)((0,a.Z)({},fe.office.contact),{firstName:e})})}))}}),(0,d.jsx)(y.Z,{label:"Last Name",name:"lastName",value:null===(P=fe.office.contact)||void 0===P?void 0:P.lastName,onChange:function(e){return ve((0,t.Z)((0,a.Z)({},fe),{office:(0,t.Z)((0,a.Z)({},fe.office),{contact:(0,t.Z)((0,a.Z)({},fe.office.contact),{lastName:e})})}))}})]}),(0,d.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 mt-4 gap-4 items-end",children:(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"mb-1",children:"Phone number"}),(0,d.jsx)(y.Z,{value:fe.office.phoneNumber||"",onChange:function(e){return function(e){var n=e.replace(/[^0-9 ()+-]+/,"");(n||""===e)&&ve((0,t.Z)((0,a.Z)({},fe),{office:(0,t.Z)((0,a.Z)({},fe.office),{phoneNumber:n})}))}(e)}})]})}),(0,d.jsx)("hr",{}),(0,d.jsx)("label",{className:"lg mb-4",children:"Business email"}),(0,d.jsx)("div",{className:"grid grid-cols-1 xl:grid-cols-1 my-4 gap-4 items-end",children:(0,d.jsxs)("div",{children:[(0,d.jsx)(y.Z,{readOnly:!!(null===fe||void 0===fe||null===(_=fe.business)||void 0===_||null===(F=_.nylas)||void 0===F?void 0:F.token),className:"mb-4",label:"Email",error:fe.office.email&&!(0,N.oH)(fe.office.email)?"You must provide a valid email":"",name:"email",type:"email",value:fe.office.email,onChange:function(e){return ve((0,t.Z)((0,a.Z)({},fe),{office:(0,t.Z)((0,a.Z)({},fe.office),{email:e})}))}}),(null===fe||void 0===fe||null===(K=fe.business)||void 0===K||null===(Y=K.nylas)||void 0===Y?void 0:Y.token)&&(0,d.jsx)("div",{className:"rounded-md bg-green-50 py-2 px-4 mb-2",children:(0,d.jsxs)("div",{className:"flex md:items-center",children:[(0,d.jsx)("div",{className:"flex-shrink-0",children:(0,d.jsx)(w.Z,{icon:"CheckIcon",className:"h-5 w-5 text-green-400","aria-hidden":"true"})}),(0,d.jsx)("div",{className:"ml-3 flex-1 md:flex md:justify-between md:items-center",children:(0,d.jsxs)("p",{className:"text-sm text-green-700",children:["Email connected via ",(0,d.jsx)("span",{className:"font-medium uppercase",children:null===fe||void 0===fe||null===(R=fe.business)||void 0===R||null===(U=R.nylas)||void 0===U?void 0:U.provider}),(null===fe||void 0===fe||null===(V=fe.business)||void 0===V||null===(H=V.nylas)||void 0===H?void 0:H.connectedAt)?" on ".concat(u.ou.fromISO(null===fe||void 0===fe||null===(W=fe.business)||void 0===W||null===(z=W.nylas)||void 0===z?void 0:z.connectedAt).toFormat("DD")):"","!"]})})]})}),(null===Le||void 0===Le||null===(G=Le.user)||void 0===G||null===(J=G.plan)||void 0===J||null===(q=J.features)||void 0===q?void 0:q.includes("sync_email"))?(0,d.jsx)(f(),{href:"/crm/settings",children:(0,d.jsxs)("a",{className:"button link flex items-center mt-2",children:[(0,d.jsx)(w.Z,{icon:"MailIcon",className:"h-5 w-5 mr-1"})," ",(null===fe||void 0===fe||null===(Q=fe.business)||void 0===Q||null===($=Q.nylas)||void 0===$?void 0:$.token)?"Manage your connected email":"Connect your email"]})}):(0,d.jsxs)(M.Z,{onClick:function(e){_e(!0)},className:"button link flex items-center mt-2",children:[(0,d.jsx)(w.Z,{icon:"MailIcon",className:"h-5 w-5 mr-1"})," Connect your email"]})]})}),(0,d.jsx)("hr",{}),(0,d.jsxs)("div",{id:"address",className:"scroll-offset",children:[(0,d.jsx)("label",{className:"lg mb-4",children:"Address"}),!We&&(0,d.jsx)("div",{className:"mb-4",children:(0,d.jsx)(x.U,{variant:"info",text:(0,d.jsxs)(d.Fragment,{children:["You're set up to accept credit card payments in ",(0,N.Iu)(ze),". To change your country, ",(0,d.jsx)("a",{href:"https://help.durable.co/",className:"link",target:"_blank",rel:"noreferrer",children:"contact support"})]})})}),(0,d.jsx)(y.Z,{name:"line1",type:"text",placeholder:"Address line 1",className:"mb-4",autocomplete:"address-line1",value:fe.office.address.line1,onChange:function(e){return ve((0,t.Z)((0,a.Z)({},fe),{office:(0,t.Z)((0,a.Z)({},fe.office),{address:(0,t.Z)((0,a.Z)({},fe.office.address),{line1:e})})}))}}),(0,d.jsx)(y.Z,{name:"line2",type:"text",placeholder:"Address line 2",autocomplete:"address-line2",value:fe.office.address.line2,onChange:function(e){return ve((0,t.Z)((0,a.Z)({},fe),{office:(0,t.Z)((0,a.Z)({},fe.office),{address:(0,t.Z)((0,a.Z)({},fe.office.address),{line2:e})})}))}}),(0,d.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 mt-4 gap-4",children:[(0,d.jsx)(j.Z,{className:"w-full",inline:Ie,value:ze,onChange:function(e){return ve((0,t.Z)((0,a.Z)({},fe),{office:(0,t.Z)((0,a.Z)({},fe.office),{address:(0,t.Z)((0,a.Z)({},fe.office.address),{country:e.code})})}))},values:N.hW.map((function(e){return(0,t.Z)((0,a.Z)({},e),{id:e.code})})),label:"Country",hasFilter:!0,disabled:!We}),"us"===(null===fe||void 0===fe||null===(X=fe.office)||void 0===X||null===(ee=X.address)||void 0===ee?void 0:ee.country.toLowerCase())||"ca"===(null===fe||void 0===fe||null===(ne=fe.office)||void 0===ne||null===(se=ne.address)||void 0===se?void 0:se.country.toLowerCase())?(0,d.jsx)(j.Z,{values:L[fe.office.address.country.toLowerCase()],inline:Ie,name:"state",type:"text",hasFilter:!0,label:"ca"===fe.office.address.country.toLowerCase()?"Province":"State",value:L[fe.office.address.country.toLowerCase()].find((function(e){return e.id===fe.office.address.state}))||L[fe.office.address.country.toLowerCase()][0],onChange:function(e){return ve((0,t.Z)((0,a.Z)({},fe),{office:(0,t.Z)((0,a.Z)({},fe.office),{address:(0,t.Z)((0,a.Z)({},fe.office.address),{state:e.id})})}))}}):(0,d.jsx)(y.Z,{name:"state",type:"text",autocomplete:"address-level1",label:"ca"===fe.office.address.country.toLowerCase()?"Province":"State",value:fe.office.address.state,onChange:function(e){return ve((0,t.Z)((0,a.Z)({},fe),{office:(0,t.Z)((0,a.Z)({},fe.office),{address:(0,t.Z)((0,a.Z)({},fe.office.address),{state:e})})}))}})]}),(0,d.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 mt-4 gap-4",children:[(0,d.jsx)(y.Z,{name:"city",type:"text",label:"City",value:fe.office.address.city,autocomplete:"address-level2",onChange:function(e){return ve((0,t.Z)((0,a.Z)({},fe),{office:(0,t.Z)((0,a.Z)({},fe.office),{address:(0,t.Z)((0,a.Z)({},fe.office.address),{city:e})})}))}}),(0,d.jsx)(y.Z,{name:"postalCode",type:"text",autocomplete:"postal-code",label:"us"!==fe.office.address.country.toLowerCase()?"Postal code":"ZIP code",value:fe.office.address.postalCode,onChange:function(e){return ve((0,t.Z)((0,a.Z)({},fe),{office:(0,t.Z)((0,a.Z)({},fe.office),{address:(0,t.Z)((0,a.Z)({},fe.office.address),{postalCode:e})})}))}})]})]}),(0,d.jsx)("hr",{}),(0,d.jsx)("div",{className:"block w-full",children:(0,d.jsxs)("div",{className:"flex flex-row flex-nowrap justify-between items-center",children:[(0,d.jsx)("p",{className:"text-label font-normal text-gray-900",children:"Make address visible to search engines like Google"}),(0,d.jsx)("span",{id:"toggle-address-public",children:(0,d.jsx)(g.Z,{enabled:pe,onChange:function(){var e,n=(0,a.Z)({},fe),s=!(null===(e=n.office.address)||void 0===e?void 0:e.public);n.office.address.public=s,xe(s),ve(n)}})})]})})]})]})]}),Ae&&(0,d.jsx)(O.Z,{open:Ae,setOpen:ke})]})}B.auth=!0}}]);